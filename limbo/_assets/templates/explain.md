# Testcase: {{ testcase_id }}

## Description

{{ testcase.description }}

## Testcase Details

| Property | Value |
|----------|-------|
| **ID** | `{{ testcase_id }}` |
| **Expected Result** | `{{ testcase.expected_result.value }}` |
| **Validation Kind** | `{{ testcase.validation_kind.value }}` |
| **Importance** | `{{ testcase.importance.value }}` |
{% if testcase.validation_time %}| **Validation Time** | `{{ testcase.validation_time }}` |
{% endif %}{% if testcase.max_chain_depth %}| **Max Chain Depth** | `{{ testcase.max_chain_depth }}` |
{% endif %}

{% if testcase.features %}
### Features

{% for feature in testcase.features %}
- `{{ feature.value }}`
{% endfor %}
{% endif %}

{% if testcase.conflicts_with %}
### Conflicts With

This testcase conflicts with the following testcases:

{% for conflict in testcase.conflicts_with %}
- `{{ conflict }}`
{% endfor %}
{% endif %}

## Certificate Chain

### Trusted Certificates

{% if testcase.trusted_certs %}
{% for i in range(testcase.trusted_certs|length) %}
<details>
<summary>Trusted Certificate {{ i + 1 }}</summary>

```
{{ testcase.trusted_certs[i] }}
```

</details>
{% endfor %}
{% else %}
No trusted certificates specified.
{% endif %}

### Untrusted Intermediates

{% if testcase.untrusted_intermediates %}
{% for i in range(testcase.untrusted_intermediates|length) %}
<details>
<summary>Intermediate Certificate {{ i + 1 }}</summary>

```
{{ testcase.untrusted_intermediates[i] }}
```

</details>
{% endfor %}
{% else %}
No untrusted intermediate certificates.
{% endif %}

### Peer Certificate

<details>
<summary>Peer (End Entity) Certificate</summary>

```
{{ testcase.peer_certificate }}
```

</details>

{% if testcase.peer_certificate_key %}
<details>
<summary>Peer Certificate Private Key</summary>

```
{{ testcase.peer_certificate_key }}
```

</details>
{% endif %}

## Validation Constraints

### Signature Algorithms

{% if testcase.signature_algorithms %}
{% for algo in testcase.signature_algorithms %}
- `{{ algo.value }}`
{% endfor %}
{% else %}
No signature algorithm constraints.
{% endif %}

### Key Usage

{% if testcase.key_usage %}
{% for ku in testcase.key_usage %}
- `{{ ku.value }}`
{% endfor %}
{% else %}
No key usage constraints.
{% endif %}

### Extended Key Usage

{% if testcase.extended_key_usage %}
{% for eku in testcase.extended_key_usage %}
- `{{ eku.value }}`
{% endfor %}
{% else %}
No extended key usage constraints.
{% endif %}

### Peer Name Validation

{% if testcase.validation_kind.value == "SERVER" %}
{% if testcase.expected_peer_name %}
**Expected Peer Name:**
- Kind: `{{ testcase.expected_peer_name.kind.value }}`
- Value: `{{ testcase.expected_peer_name.value }}`
{% else %}
No expected peer name specified.
{% endif %}
{% else %}
{% if testcase.expected_peer_names %}
**Expected Peer Names:**
{% for peer_name in testcase.expected_peer_names %}
- Kind: `{{ peer_name.kind.value }}`, Value: `{{ peer_name.value }}`
{% endfor %}
{% else %}
No expected peer names specified.
{% endif %}
{% endif %}

{% if testcase.crls %}
### Certificate Revocation Lists (CRLs)

{% for i in range(testcase.crls|length) %}
<details>
<summary>CRL {{ i + 1 }}</summary>

```
{{ testcase.crls[i] }}
```

</details>
{% endfor %}
{% endif %}

---

*This explanation was generated by `limbo explain {{ testcase_id }}`*
